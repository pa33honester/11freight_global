import{d as U,j as v,k as C,c as g,a,u as s,h as q,w as l,b as n,T as F,o as c,i as R,g as d,t as h,f as V,F as k,r as j,n as z,v as I,e as N,l as J}from"./app-Ce1PEk3E.js";import{_ as A,a as B,b as E}from"./index-XrivC8CO.js";import{_ as $}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Ce_KBTPN.js";import{_ as K,a as P,b as X,c as G}from"./CardTitle.vue_vue_type_script_setup_true_lang-BWo3PFTo.js";import{_ as H}from"./CardDescription.vue_vue_type_script_setup_true_lang-J0qUB_QG.js";import{_ as Q}from"./Input.vue_vue_type_script_setup_true_lang-BbOMO5jb.js";import{_ as W}from"./AppLayout.vue_vue_type_script_setup_true_lang-D5_zQ9oX.js";import"./index-DN-339kb.js";import"./VisuallyHidden-8lUJdWoX.js";import"./useForwardExpose-DdplqLb_.js";import"./useForwardPropsEmits-BWT1dgiP.js";import"./index-BsePJUay.js";import"./createLucideIcon-DgoLutV8.js";const Y={class:"fixed top-6 right-6 z-50 flex flex-col items-end space-y-3"},Z={class:"list-inside list-disc text-sm"},ee={class:"p-4"},te={class:"mb-4"},se={class:"space-y-2 mt-2"},ae=["id","value","onChange"],le=["for"],oe={class:"mb-4"},ne={class:"flex items-center gap-2 mt-2"},re={class:"flex items-center gap-2"},ie=U({__name:"Show",props:{user:{},roles:{}},setup(w){const o=w,i=v(o.user.role_names&&o.user.role_names.length?o.user.role_names[0]:""),f=C({roles:i.value?[i.value]:[]}),m=C({name:""}),x=v(!1),p=v(""),_=v([]);let y=null,b=null;function O(r){p.value=r,y&&window.clearTimeout(y),y=window.setTimeout(()=>{p.value="",y=null},4e3)}function S(r){_.value=r,b&&window.clearTimeout(b),b=window.setTimeout(()=>{_.value=[],b=null},6e3)}const T=v(Array.isArray(o.roles)?o.roles.slice():[]);function M(){p.value="",_.value=[],f.post(`/admin/staff/${o.user.id}/roles`,{onSuccess:()=>{O("Roles updated."),_.value=[]},onError:r=>{try{const e=[];Object.values(r).forEach(t=>{Array.isArray(t)?e.push(...t):typeof t=="string"&&e.push(t)}),S(e.length?e:["Failed to update roles."])}catch(e){console.log(e),S(["Failed to update roles."])}}})}function D(){if(!m.name)return;x.value=!0;const r=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"";fetch("/admin/roles",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":r},body:JSON.stringify({name:m.name})}).then(async e=>{if(!e.ok)throw e;const t=await e.json();T.value.push(t),f.roles=[t.name],i.value=t.name,m.name=""}).catch(async e=>{let t="Failed to create role.";try{const u=await e.json();u?.message&&(t=u.message)}catch(u){console.log(u)}alert(t)}).finally(()=>{x.value=!1})}function L(r){i.value=r,f.roles=[r]}return(r,e)=>(c(),g(k,null,[a(s(q),{title:`Staff - ${o.user.name}`},null,8,["title"]),a(W,{breadcrumbs:[{title:"Staff & Roles",href:"/admin/staff"},{title:o.user.name,href:`/admin/staff/${o.user.id}`}]},{default:l(()=>[n("div",Y,[a(F,{name:"fade"},{default:l(()=>[p.value?(c(),R(s(A),{key:0,class:"w-96 bg-gradient-to-r from-emerald-500 to-emerald-400 text-white shadow-lg ring-1 ring-emerald-300"},{default:l(()=>[a(s(B),{class:"text-white"},{default:l(()=>[...e[2]||(e[2]=[d("Success",-1)])]),_:1}),a(s(E),{class:"text-white"},{default:l(()=>[d(h(p.value),1)]),_:1})]),_:1})):V("",!0)]),_:1}),a(F,{name:"fade"},{default:l(()=>[_.value.length?(c(),R(s(A),{key:0,variant:"destructive",class:"w-96 bg-gradient-to-r from-rose-600 to-rose-500 text-white shadow-lg ring-1 ring-rose-400"},{default:l(()=>[a(s(B),{class:"text-white"},{default:l(()=>[...e[3]||(e[3]=[d("Failed",-1)])]),_:1}),a(s(E),{class:"text-white"},{default:l(()=>[n("ul",Z,[(c(!0),g(k,null,j(_.value,(t,u)=>(c(),g("li",{key:u},h(t),1))),128))])]),_:1})]),_:1})):V("",!0)]),_:1})]),n("div",ee,[a(s(K),null,{default:l(()=>[a(s(P),null,{default:l(()=>[a(s(X),null,{default:l(()=>[d(h(o.user.name),1)]),_:1}),a(s(H),null,{default:l(()=>[d(h(o.user.email),1)]),_:1})]),_:1}),a(s(G),null,{default:l(()=>[n("div",te,[e[4]||(e[4]=n("h3",{class:"font-medium"},"Roles",-1)),n("div",se,[(c(!0),g(k,null,j(T.value,t=>(c(),g("div",{key:t.id,class:"flex items-center gap-2"},[z(n("input",{type:"radio",id:`role-${t.id}`,value:t.name,"onUpdate:modelValue":e[0]||(e[0]=u=>i.value=u),onChange:()=>L(t.name),class:"form-radio"},null,40,ae),[[I,i.value]]),n("label",{for:`role-${t.id}`},h(t.name),9,le)]))),128))])]),n("div",oe,[e[6]||(e[6]=n("h4",{class:"font-medium"},"Create Role",-1)),n("div",ne,[a(s(Q),{modelValue:s(m).name,"onUpdate:modelValue":e[1]||(e[1]=t=>s(m).name=t),placeholder:"New role name"},null,8,["modelValue"]),a(s($),{disabled:x.value,onClick:N(D,["prevent"])},{default:l(()=>[...e[5]||(e[5]=[d("Create",-1)])]),_:1},8,["disabled"])])]),n("div",re,[a(s($),{disabled:s(f).processing,onClick:N(M,["prevent"])},{default:l(()=>[...e[7]||(e[7]=[d("Save Roles",-1)])]),_:1},8,["disabled"]),a(s(J),{href:"/admin/staff"},{default:l(()=>[a(s($),{variant:"ghost"},{default:l(()=>[...e[8]||(e[8]=[d("Back",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["breadcrumbs"])],64))}}),ue=(w,o)=>{const i=w.__vccOpts||w;for(const[f,m]of o)i[f]=m;return i},ke=ue(ie,[["__scopeId","data-v-0429c4a6"]]);export{ke as default};
