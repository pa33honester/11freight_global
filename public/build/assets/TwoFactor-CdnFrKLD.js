import{d as E,i as y,u as e,w as o,a as t,g as f,t as C,b as a,c as i,F as b,r as T,y as O,o as s,j as k,ak as U,D as Y,a0 as Z,ag as z,E as V,f as ee,A as te,M as W,aj as ae,ah as se,m as oe,R as re,ai as ne,C as le,O as ie,h as ce,K as de,L as ue}from"./app-ZoMEvklz.js";import{r as fe,s as pe,q as ve,c as ye,d as me,f as he,_ as be,a as _e,g as we,h as ge}from"./Layout.vue_vue_type_script_setup_true_lang-CvaR8S2b.js";import{_ as ke,a as xe,b as Ce}from"./index--MqbCbIJ.js";import{c as _}from"./createLucideIcon-Db4teo7l.js";import{_ as g,P as $e,c as Se,a as Fe}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CSrLiVPg.js";import{_ as Te,b as Me,a as Re,c as Ae}from"./CardTitle.vue_vue_type_script_setup_true_lang-FJdKs83x.js";import{_ as Ee}from"./CardDescription.vue_vue_type_script_setup_true_lang-DH2VU6NV.js";import{s as qe,r as je}from"./index-CsgO9ZAL.js";import{_ as ze}from"./InputError.vue_vue_type_script_setup_true_lang-C23JJ7PH.js";import{_ as Ve}from"./Input.vue_vue_type_script_setup_true_lang-B8cJiyck.js";import{_ as De,b as Ie,c as Be,a as Oe}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BUng5hS9.js";import{_ as Le}from"./DialogDescription.vue_vue_type_script_setup_true_lang-n_4U53fr.js";import{_ as Pe,a as Ke,b as He}from"./InputOTPSlot.vue_vue_type_script_setup_true_lang-DDJ__pL8.js";import{_ as H}from"./Spinner.vue_vue_type_script_setup_true_lang-pIxMOKEd.js";import{C as Ne}from"./check-jN4Mf34Z.js";import{_ as Qe}from"./AppLayout.vue_vue_type_script_setup_true_lang-D_gnfnQh.js";import"./index-n1LTNkzM.js";import"./index-CT1Imaic.js";import"./useForwardPropsEmits-CGUFY8cM.js";import"./VisuallyHidden-BGncnRsO.js";import"./useForwardExpose-CuBcqR0n.js";const Ue=_("CircleAlertIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const We=_("CopyIcon",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);const Je=_("EyeOffIcon",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const Ge=_("EyeIcon",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Xe=_("LockKeyholeIcon",[["circle",{cx:"12",cy:"16",r:"1",key:"1au0dj"}],["rect",{x:"3",y:"10",width:"18",height:"12",rx:"2",key:"6s8ecr"}],["path",{d:"M7 10V7a5 5 0 0 1 10 0v3",key:"1pqi11"}]]);const Ye=_("RefreshCwIcon",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const Ze=_("ScanLineIcon",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);const et=_("ShieldBanIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m4.243 5.21 14.39 12.472",key:"1c9a7c"}]]);const N=_("ShieldCheckIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),tt={class:"list-inside list-disc text-sm"},J=E({__name:"AlertError",props:{errors:{},title:{default:"Something went wrong."}},setup(c){const n=c,p=O(()=>Array.from(new Set(n.errors)));return(l,d)=>(s(),y(e(ke),{variant:"destructive"},{default:o(()=>[t(e(Ue),{class:"size-4"}),t(e(xe),null,{default:o(()=>[f(C(c.title),1)]),_:1}),t(e(Ce),null,{default:o(()=>[a("ul",tt,[(s(!0),i(b,null,T(p.value,(w,r)=>(s(),i("li",{key:r},C(w),1))),128))])]),_:1})]),_:1}))}}),B=async c=>{const n=await fetch(c,{headers:{Accept:"application/json"}});if(!n.ok)throw new Error(`Failed to fetch: ${n.status}`);return n.json()},A=k([]),S=k(null),F=k(null),j=k([]),at=O(()=>F.value!==null&&S.value!==null),L=()=>{const c=async()=>{try{const{svg:v}=await B(ve.url());F.value=v}catch{A.value.push("Failed to fetch QR code"),F.value=null}},n=async()=>{try{const{secretKey:v}=await B(pe.url());S.value=v}catch{A.value.push("Failed to fetch a setup key"),S.value=null}},p=()=>{S.value=null,F.value=null,l()},l=()=>{A.value=[]};return{qrCodeSvg:F,manualSetupKey:S,recoveryCodesList:j,errors:A,hasSetupData:at,clearSetupData:p,clearErrors:l,clearTwoFactorAuthData:()=>{p(),l(),j.value=[]},fetchQrCode:c,fetchSetupKey:n,fetchSetupData:async()=>{try{l(),await Promise.all([c(),n()])}catch{F.value=null,S.value=null}},fetchRecoveryCodes:async()=>{try{l(),j.value=await B(fe.url())}catch{A.value.push("Failed to fetch recovery codes"),j.value=[]}}}},st={class:"flex flex-col gap-3 select-none sm:flex-row sm:items-center sm:justify-between"},ot={key:0,class:"mt-6"},rt={key:1,class:"mt-3 space-y-3"},nt={key:0,class:"space-y-2"},lt=E({__name:"TwoFactorRecoveryCodes",setup(c){const{recoveryCodesList:n,fetchRecoveryCodes:p,errors:l}=L(),d=k(!1),w=U("recoveryCodeSectionRef"),r=async()=>{!d.value&&!n.value.length&&await p(),d.value=!d.value,d.value&&(await W(),w.value?.scrollIntoView({behavior:"smooth"}))};return Y(async()=>{n.value.length||await p()}),(v,m)=>(s(),y(e(Te),{class:"w-full"},{default:o(()=>[t(e(Re),null,{default:o(()=>[t(e(Me),{class:"flex gap-3"},{default:o(()=>[t(e(Xe),{class:"size-4"}),m[0]||(m[0]=f("2FA Recovery Codes ",-1))]),_:1}),t(e(Ee),null,{default:o(()=>[...m[1]||(m[1]=[f(" Recovery codes let you regain access if you lose your 2FA device. Store them in a secure password manager. ",-1)])]),_:1})]),_:1}),t(e(Ae),null,{default:o(()=>[a("div",st,[t(e(g),{onClick:r,class:"w-fit"},{default:o(()=>[(s(),y(Z(d.value?e(Je):e(Ge)),{class:"size-4"})),f(" "+C(d.value?"Hide":"View")+" Recovery Codes ",1)]),_:1}),d.value&&e(n).length?(s(),y(e(z),V({key:0},e(ye).form(),{method:"post",options:{preserveScroll:!0},onSuccess:e(p)}),{default:o(({processing:x})=>[t(e(g),{variant:"secondary",type:"submit",disabled:x},{default:o(()=>[t(e(Ye)),m[2]||(m[2]=f(" Regenerate Codes ",-1))]),_:1},8,["disabled"])]),_:1},16,["onSuccess"])):ee("",!0)]),a("div",{class:te(["relative overflow-hidden transition-all duration-300",d.value?"h-auto opacity-100":"h-0 opacity-0"])},[e(l)?.length?(s(),i("div",ot,[t(J,{errors:e(l)},null,8,["errors"])])):(s(),i("div",rt,[a("div",{ref_key:"recoveryCodeSectionRef",ref:w,class:"grid gap-1 rounded-lg bg-muted p-4 font-mono text-sm"},[e(n).length?(s(!0),i(b,{key:1},T(e(n),(x,q)=>(s(),i("div",{key:q},C(x),1))),128)):(s(),i("div",nt,[(s(),i(b,null,T(8,x=>a("div",{key:x,class:"h-4 animate-pulse rounded bg-muted-foreground/20"})),64))]))],512),m[3]||(m[3]=a("p",{class:"text-xs text-muted-foreground select-none"},[f(" Each recovery code can be used once to access your account and will be removed after use. If you need more, click "),a("span",{class:"font-bold"},"Regenerate Codes"),f(" above. ")],-1))]))],2)]),_:1})]),_:1}))}}),it={class:"mb-3 w-auto rounded-full border border-border bg-card p-0.5 shadow-sm"},ct={class:"relative overflow-hidden rounded-full border border-border bg-muted p-2.5"},dt={class:"absolute inset-0 grid grid-cols-5 opacity-50"},ut={class:"absolute inset-0 grid grid-rows-5 opacity-50"},ft={class:"relative flex w-auto flex-col items-center justify-center space-y-5"},pt={class:"relative mx-auto flex max-w-md items-center overflow-hidden"},vt={class:"relative mx-auto aspect-square w-64 overflow-hidden rounded-lg border border-border"},yt={key:0,class:"absolute inset-0 z-10 flex aspect-square h-auto w-full animate-pulse items-center justify-center bg-background"},mt={key:1,class:"relative z-10 overflow-hidden border p-5"},ht=["innerHTML"],bt={class:"flex w-full items-center space-x-5"},_t={class:"flex w-full items-center justify-center space-x-2"},wt={class:"flex w-full items-stretch overflow-hidden rounded-xl border border-border"},gt={key:0,class:"flex h-full w-full items-center justify-center bg-muted p-3"},kt=["value"],xt={class:"flex w-full flex-col items-center justify-center space-y-3 py-2"},Ct={class:"flex w-full items-center space-x-5"},$t=E({__name:"TwoFactorSetupModal",props:ne({requiresConfirmation:{type:Boolean},twoFactorEnabled:{type:Boolean}},{isOpen:{type:Boolean},isOpenModifiers:{}}),emits:["update:isOpen"],setup(c){const{resolvedAppearance:n}=ae(),p=c,l=se(c,"isOpen"),{copy:d,copied:w}=qe(),{qrCodeSvg:r,manualSetupKey:v,clearSetupData:m,fetchSetupData:x,errors:q}=L(),M=k(!1),$=k(""),P=U("pinInputContainerRef"),D=O(()=>p.twoFactorEnabled?{title:"Two-Factor Authentication Enabled",description:"Two-factor authentication is now enabled. Scan the QR code or enter the setup key in your authenticator app.",buttonText:"Close"}:M.value?{title:"Verify Authentication Code",description:"Enter the 6-digit code from your authenticator app",buttonText:"Continue"}:{title:"Enable Two-Factor Authentication",description:"To finish enabling two-factor authentication, scan the QR code or enter the setup key in your authenticator app",buttonText:"Continue"}),G=()=>{if(p.requiresConfirmation){M.value=!0,W(()=>{P.value?.querySelector("input")?.focus()});return}m(),l.value=!1},X=()=>{p.twoFactorEnabled&&m(),M.value=!1,$.value=""};return oe(()=>l.value,async K=>{if(!K){X();return}r.value||await x()}),(K,u)=>(s(),y(e(De),{open:l.value,"onUpdate:open":u[5]||(u[5]=h=>l.value=h)},{default:o(()=>[t(e(Oe),{class:"sm:max-w-md"},{default:o(()=>[t(e(Ie),{class:"flex items-center justify-center"},{default:o(()=>[a("div",it,[a("div",ct,[a("div",dt,[(s(),i(b,null,T(5,h=>a("div",{key:`col-${h}`,class:"border-r border-border last:border-r-0"})),64))]),a("div",ut,[(s(),i(b,null,T(5,h=>a("div",{key:`row-${h}`,class:"border-b border-border last:border-b-0"})),64))]),t(e(Ze),{class:"relative z-20 size-6 text-foreground"})])]),t(e(Be),null,{default:o(()=>[f(C(D.value.title),1)]),_:1}),t(e(Le),{class:"text-center"},{default:o(()=>[f(C(D.value.description),1)]),_:1})]),_:1}),a("div",ft,[M.value?(s(),y(e(z),V({key:1},e(me).form(),{"reset-on-error":"",onFinish:u[3]||(u[3]=h=>$.value=""),onSuccess:u[4]||(u[4]=h=>l.value=!1)}),{default:o(({errors:h,processing:I})=>[a("input",{type:"hidden",name:"code",value:$.value},null,8,kt),a("div",{ref_key:"pinInputContainerRef",ref:P,class:"relative w-full space-y-3"},[a("div",xt,[t(e(Pe),{id:"otp",modelValue:$.value,"onUpdate:modelValue":u[1]||(u[1]=R=>$.value=R),maxlength:6,disabled:I},{default:o(()=>[t(e(Ke),null,{default:o(()=>[(s(),i(b,null,T(6,R=>t(e(He),{key:R,index:R-1},null,8,["index"])),64))]),_:1})]),_:1},8,["modelValue","disabled"]),t(ze,{message:h?.confirmTwoFactorAuthentication?.code},null,8,["message"])]),a("div",Ct,[t(e(g),{type:"button",variant:"outline",class:"w-auto flex-1",onClick:u[2]||(u[2]=R=>M.value=!1),disabled:I},{default:o(()=>[...u[7]||(u[7]=[f(" Back ",-1)])]),_:1},8,["disabled"]),t(e(g),{type:"submit",class:"w-auto flex-1",disabled:I||$.value.length<6},{default:o(()=>[...u[8]||(u[8]=[f(" Confirm ",-1)])]),_:1},8,["disabled"])])],512)]),_:1},16)):(s(),i(b,{key:0},[e(q)?.length?(s(),y(J,{key:0,errors:e(q)},null,8,["errors"])):(s(),i(b,{key:1},[a("div",pt,[a("div",vt,[e(r)?(s(),i("div",mt,[a("div",{innerHTML:e(r),class:"flex aspect-square size-full items-center justify-center",style:re({filter:e(n)==="dark"?"invert(1) brightness(1.5)":void 0})},null,12,ht)])):(s(),i("div",yt,[t(e(H),{class:"size-6"})]))])]),a("div",bt,[t(e(g),{class:"w-full",onClick:G},{default:o(()=>[f(C(D.value.buttonText),1)]),_:1})]),u[6]||(u[6]=a("div",{class:"relative flex w-full items-center justify-center"},[a("div",{class:"absolute inset-0 top-1/2 h-px w-full bg-border"}),a("span",{class:"relative bg-card px-2 py-1"},"or, enter the code manually")],-1)),a("div",_t,[a("div",wt,[e(v)?(s(),i(b,{key:1},[t(e(Ve),{readonly:"",value:e(v),class:"h-full w-full bg-background p-3 text-foreground"},null,8,["value"]),a("button",{onClick:u[0]||(u[0]=h=>e(d)(e(v)||"")),class:"relative block h-auto border-l border-border px-3 hover:bg-muted"},[e(w)?(s(),y(e(Ne),{key:0,class:"w-4 text-green-500"})):(s(),y(e(We),{key:1,class:"w-4"}))])],64)):(s(),i("div",gt,[t(e(H))]))])])],64))],64))])]),_:1})]),_:1},8,["open"]))}}),Q=E({__name:"Badge",props:{asChild:{type:Boolean},as:{},variant:{},class:{}},setup(c){const n=c,p=je(n,"class");return(l,d)=>(s(),y(e($e),V({"data-slot":"badge",class:e(Se)(e(St)({variant:c.variant}),n.class)},e(p)),{default:o(()=>[le(l.$slots,"default")]),_:3},16,["class"]))}}),St=Fe("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}}),Ft={class:"space-y-6"},Tt={key:0,class:"flex flex-col items-start justify-start space-y-4"},Mt={key:1,class:"flex flex-col items-start justify-start space-y-4"},Rt={class:"relative inline"},Yt=E({__name:"TwoFactor",props:{requiresConfirmation:{type:Boolean,default:!1},twoFactorEnabled:{type:Boolean,default:!1}},setup(c){const n=[{title:"Two-Factor Authentication",href:he.url()}],{hasSetupData:p,clearTwoFactorAuthData:l}=L(),d=k(!1);return ie(()=>{l()}),(w,r)=>(s(),y(Qe,{breadcrumbs:n},{default:o(()=>[t(e(ce),{title:"Two-Factor Authentication"}),r[10]||(r[10]=a("h1",{class:"sr-only"},"Two-Factor Authentication Settings",-1)),t(be,null,{default:o(()=>[a("div",Ft,[t(_e,{variant:"small",title:"Two-Factor Authentication",description:"Manage your two-factor authentication settings"}),c.twoFactorEnabled?(s(),i("div",Mt,[t(e(Q),{variant:"default"},{default:o(()=>[...r[7]||(r[7]=[f("Enabled",-1)])]),_:1}),r[9]||(r[9]=a("p",{class:"text-muted-foreground"}," With two-factor authentication enabled, you will be prompted for a secure, random pin during login, which you can retrieve from the TOTP-supported application on your phone. ",-1)),t(lt),a("div",Rt,[t(e(z),de(ue(e(ge).form())),{default:o(({processing:v})=>[t(e(g),{variant:"destructive",type:"submit",disabled:v},{default:o(()=>[t(e(et)),r[8]||(r[8]=f(" Disable 2FA ",-1))]),_:1},8,["disabled"])]),_:1},16)])])):(s(),i("div",Tt,[t(e(Q),{variant:"destructive"},{default:o(()=>[...r[3]||(r[3]=[f("Disabled",-1)])]),_:1}),r[6]||(r[6]=a("p",{class:"text-muted-foreground"}," When you enable two-factor authentication, you will be prompted for a secure pin during login. This pin can be retrieved from a TOTP-supported application on your phone. ",-1)),a("div",null,[e(p)?(s(),y(e(g),{key:0,onClick:r[0]||(r[0]=v=>d.value=!0)},{default:o(()=>[t(e(N)),r[4]||(r[4]=f("Continue Setup ",-1))]),_:1})):(s(),y(e(z),V({key:1},e(we).form(),{onSuccess:r[1]||(r[1]=v=>d.value=!0)}),{default:o(({processing:v})=>[t(e(g),{type:"submit",disabled:v},{default:o(()=>[t(e(N)),r[5]||(r[5]=f("Enable 2FA",-1))]),_:1},8,["disabled"])]),_:1},16))])])),t($t,{isOpen:d.value,"onUpdate:isOpen":r[2]||(r[2]=v=>d.value=v),requiresConfirmation:c.requiresConfirmation,twoFactorEnabled:c.twoFactorEnabled},null,8,["isOpen","requiresConfirmation","twoFactorEnabled"])])]),_:1})]),_:1}))}});export{Yt as default};
